import { Component, OnInit, Input } from '@angular/core';
import { SRecordReader, SRecordWriter, Block } from './srec';
import { str2srec } from './srec-observable';
import { from } from 'rxjs';
import { map } from 'rxjs/operators';

const input = from( `S00D000053616D706C652E6D6F7412
S31508000000001800203D030008010300080B03000840
S3150800001000000000000000000000000000000000D2
S3150800002000000000000000000000000011030008A6
S3150800003000000000000000001B030008250300085C
S31508000040BD030008BD030008BD030008BD03000882
S31508000050BD030008BD030008BD030008BD03000872
S31508000060BD030008BD030008BD030008BD03000862
S31508000070BD030008BD030008BD030008BD03000852
S31508000080BD0300080000000000000000BD030008D2
S3150800009000000000BD030008BD030008BD030008FA
S315080000A000000000BD030008BD030008BD030008EA
S315080000B0BD03000800000000BD030008BD030008DA
S315080000C010B5064C2378002B07D1054B002B02D020
S315080000D0044800E000BF0123237010BD0C00002077
S315080000E00000000004100008044B10B5002B03D0D4
S315080000F00349044800E000BF10BDC04600000000E8
S315080001001000002004100008002243088B4274D314
S3150800011003098B425FD3030A8B4244D3030B8B42FA
S3150800012028D3030C8B420DD3FF22090212BA030C03
S315080001308B4202D31212090265D0030B8B4219D3E4
S3150800014000E0090AC30B8B4201D3CB03C01A524104
S31508000150830B8B4201D38B03C01A5241430B8B424C
S3150800016001D34B03C01A5241030B8B4201D30B0335
S31508000170C01A5241C30A8B4201D3CB02C01A52415C
S31508000180830A8B4201D38B02C01A5241430A8B421F
S3150800019001D34B02C01A5241030A8B4201D30B0208
S315080001A0C01A5241CDD2C3098B4201D3CB01C01A22
S315080001B0524183098B4201D38B01C01A524143092C
S315080001C08B4201D34B01C01A524103098B4201D31A
S315080001D00B01C01A5241C3088B4201D3CB00C01A87
S315080001E0524183088B4201D38B00C01A52414308FF
S315080001F08B4201D34B00C01A5241411A00D2014624
S31508000200524110467047FFE701B5002000F006F896
S3150800021002BDC0460029F7D076E770477047C0464A
S3150800022080B500AF00F0CCF800F001F8FEE790B515
S3150800023093B000AF14243B19180034231A00002188
S3150800024000F0D8FE3B1D180010231A00002100F00C
S31508000250D1FE21007B1802221A607B180122DA607F
S315080002607B1810221A617B1800225A627B18180024
S3150800027000F0BEF9031E01D000F019F83B1D072255
S315080002801A603B1D00225A603B1D00229A603B1DE6
S315080002900022DA603B1D0021180000F02FFD031E26
S315080002A001D000F004F8C046BD4613B090BD80B535
S315080002B000AFC046BD4680BD80B582B000AF0F4BCB
S315080002C09A690E4B01210A439A610C4B9B690122DC
S315080002D013407B607B68094BDA69084B8021490526
S315080002E00A43DA61054BDA6980235B0513403B60F4
S315080002F03B68C046BD4602B080BDC04600100240FD
S3150800030080B500AFC046BD4680BD80B500AFFEE7EC
S3150800031080B500AFC046BD4680BD80B500AFC046BB
S31508000320BD4680BD80B500AF00F092F8C046BD4618
S3150800033080BD80B500AFC046BD4680BD1348854622
S3150800034013480168090E134A914205D11248134908
S31508000350016013481349016013481449144A0023DD
S3150800036002E0D458C4500433C4188C42F9D3114A55
S31508000370114C002301E013600432A242FBD3FFF7BD
S31508000380D8FF00F013FEFFF74BFFFEE7001800202A
S31508000390040000001F0000001810024001000000C1
S315080003A00000014000000000000000200C000020B2
S315080003B0541000080C0000202C000020FEE7000066
S315080003C080B500AF074B1A68064B10210A431A601E
S315080003D0002000F009F8FFF76FFF00231800BD465C
S315080003E080BDC0460020024090B583B000AF78605B
S315080003F0144B1C68144B1B781900FA239800FFF756
S3150800040083FE030019002000FFF77EFE0300180094
S3150800041000F0E1F8031E01D001230FE07B68032BEF
S315080004200BD8796801235B420022180000F0BEF859
S31508000430064B7A681A60002300E001231800BD46BF
S3150800044003B090BD00000020080000200400002032
S3150800045080B500AF054B1B781A00054B1B68D218F0
S31508000460034B1A60C046BD4680BDC0460800002042
S315080004702800002080B500AF024B1B681800BD4657
S3150800048080BDC0462800002090B583B000AF0200AA
S315080004903960FB1D1A70FB1D1B787F2B28D82F4A45
S315080004A0FB1D1B785BB29B08C0339B009B58FA1D4B
S315080004B01278110003220A40D200FF2191400A0057
S315080004C0D2431A4011003B689B01FF221A40FB1DCC
S315080004D01B78180003230340DB009A401F48FB1DC6
S315080004E01B785BB29B080A43C0339B001A5031E065
S315080004F01B4AFB1D1B7819000F230B40083B9B0862
S3150800050006339B00D31804331B68FA1D12781100B2
S3150800051003220A40D200FF2191400A00D2431A4022
S3150800052011003B689B01FF221A40FB1D1B7818002F
S3150800053003230340DB009A400948FB1D1B781C0077
S315080005400F232340083B9B080A4306339B00C31826
S3150800055004331A60C046BD4603B090BD00E100E012
S3150800056000ED00E080B582B000AF78607B68013BA3
S315080005700C4A934201D9012310E00B4B7A68013AE1
S315080005805A6001235B4203211800FFF77DFF064BE3
S3150800059000229A60044B07221A6000231800BD4601
S315080005A002B080BDFFFFFF0010E000E080B584B018
S315080005B000AFB9607A600F217B18021C1A70BA68FE
S315080005C07B181B785BB211001800FFF75DFFC04669
S315080005D0BD4604B080BD80B582B000AF78607B6848
S315080005E01800FFF7BFFF03001800BD4602B080BD24
S315080005F080B588B000AF78607B68002B02D10123F4
S3150800060000F076FB7B681B680122134000D18EE060
S31508000610C54B5B680C221340042B0ED0C24B5B689B
S315080006200C221340082B17D1BF4B5A68C0235B0214
S315080006301A4080235B029A420ED1BB4B1A6880236C
S315080006409B02134000D171E07B685B68002B00D0E9
S315080006506CE0012300F04CFB7B685B68012B07D13B
S31508000660B14B1A68B04B802149020A431A602FE041
S315080006707B685B68002B0CD1AB4B1A68AA4BAB495D
S315080006800A401A60A84B1A68A74BA9490A401A607B
S315080006901EE07B685B68052B0ED1A34B1A68A24B3C
S315080006A08021C9020A431A609F4B1A689E4B802113
S315080006B049020A431A600BE09B4B1A689A4B9B49FE
S315080006C00A401A60984B1A68974B99490A401A606B
S315080006D07B685B68002B14D0FFF7CCFE0300BB6178
S315080006E008E0FFF7C7FE0200BB69D31A642B01D9DD
S315080006F00323FDE28C4B1A6880239B021340F0D03B
S3150800070015E0FFF7B7FE0300BB6108E0FFF7B2FE8E
S315080007100200BB69D31A642B01D90323E8E2824B92
S315080007201A6880239B021340F0D100E0C0467B681C
S315080007301B680222134000D16CE07B4B5B680C22DD
S3150800074013400ED0784B5B680C221340082B1FD140
S31508000750754B5A68C0235B021A4080231B029A42D3
S3150800076016D1714B1B680222134005D07B68DB68E3
S31508000770012B01D00123BBE26B4B1B68F822934384
S3150800078019007B681B69DA00674B0A431A6041E067
S315080007907B68DB68002B24D0634B1A68624B012107
S315080007A00A431A60FFF766FE0300BB6108E0FFF71D
S315080007B061FE0200BB69D31A022B01D9032397E213
S315080007C0594B1B6802221340F1D0574B1B68F8227D
S315080007D0934319007B681B69DA00534B0A431A6076
S315080007E018E0514B1A68504B01218A431A60FFF7EB
S315080007F041FE0300BB6108E0FFF73CFE0200BB694F
S31508000800D31A022B01D9032372E2474B1B68022233
S315080008101340F1D17B681B680822134036D07B68E9
S31508000820DB69002B19D0404B5A6A3F4B01210A431A
S315080008305A62FFF71FFE0300BB6108E0FFF71AFEC6
S315080008400200BB69D31A022B01D9032350E2364BA7
S315080008505B6A02221340F1D018E0334B5A6A324BD6
S3150800086001218A435A62FFF705FE0300BB6108E0CF
S31508000870FFF700FE0200BB69D31A022B01D9032336
S3150800088036E2294B5B6A02221340F1D17B681B686A
S315080008900422134000D1B5E01F23FB1800221A706A
S315080008A0214BDA6980235B05134011D11E4BDA69A7
S315080008B01D4B802149050A43DA611B4BDA698023FF
S315080008C05B051340FB60FB681F23FB1801221A70A7
S315080008D0184B1A6880235B0013401AD1154B1A6807
S315080008E0144B802149000A431A60FFF7C3FD030031
S315080008F0BB6108E0FFF7BEFD0200BB69D31A642B93
S3150800090001D90323F4E10B4B1A6880235B001340DB
S31508000910F0D07B689B68012B0ED1034B1A6A024BF9
S3150800092001210A431A6235E000100240FFFFFEFF6C
S31508000930FFFFFBFF007000407B689B68002B0CD113
S31508000940CA4B1A6AC94B01218A431A62C74B1A6AEB
S31508000950C64B04218A431A621CE07B689B68052BF8
S315080009600CD1C24B1A6AC14B04210A431A62BF4B07
S315080009701A6ABE4B01210A431A620BE0BB4B1A6A7C
S31508000980BA4B01218A431A62B84B1A6AB74B04213B
S315080009908A431A627B689B68002B14D0FFF76AFDAE
S315080009A00300BB6109E0FFF765FD0200BB69D31AC6
S315080009B0AF4A934201D903239AE1AC4B1B6A022240
S315080009C01340F0D013E0FFF755FD0300BB6109E0C3
S315080009D0FFF750FD0200BB69D31AA54A934201D915
S315080009E0032385E1A14B1B6A02221340F0D11F2382
S315080009F0FB181B78012B05D19C4BDA699B4B9D494B
S31508000A000A40DA617B681B681022134063D07B6852
S31508000A105B69012B2AD1954B5A6B944B04210A43E7
S31508000A205A63924B5A6B914B01210A435A63FFF75B
S31508000A3021FD0300BB6108E0FFF71CFD0200BB694E
S31508000A40D31A022B01D9032352E1884B5B6B02228E
S31508000A501340F1D0854B5B6BF822934319007B68F2
S31508000A609B69DA00814B0A435A6334E07B685B6909
S31508000A70053311D17D4B5A6B7C4B04218A435A634B
S31508000A807A4B5B6BF822934319007B689B69DA0003
S31508000A90764B0A435A631EE0744B5A6B734B042118
S31508000AA00A435A63714B5A6B704B01218A435A6346
S31508000AB0FFF7E0FC0300BB6108E0FFF7DBFC020080
S31508000AC0BB69D31A022B01D9032311E1674B5B6B70
S31508000AD002221340F1D17B681B68202213405CD0A8
S31508000AE0624B5B680C2213400C2B0ED05F4B5B6885
S31508000AF00C221340082B14D15C4B5A68C0235B02A6
S31508000B001A40C0235B029A420BD1584B5A6B80237A
S31508000B105B02134040D07B681B6A012B3CD0012343
S31508000B20E6E07B681B6A002B1BD0504B5A6B4F4B79
S31508000B30802149020A435A63FFF79CFC0300BB6104
S31508000B4008E0FFF797FC0200BB69D31A022B01D90C
S31508000B500323CDE0454B5A6B80235B021340F0D04C
S31508000B601BE0424B5A6B414B43490A405A63FFF715
S31508000B7081FC0300BB6108E0FFF77CFC0200BB694F
S31508000B80D31A022B01D90323B2E0384B5A6B8023C0
S31508000B905B021340F0D100E0C0467B685B6A002B1D
S31508000BA000D1A4E0314B5B680C221340082B00D11E
S31508000BB078E07B685B6A022B4CD12C4B1A682B4B6E
S31508000BC02E490A401A60FFF755FC0300BB6108E08E
S31508000BD0FFF750FC0200BB69D31A022B01D9032385
S31508000BE086E0224B1A6880239B041340F0D11F4BE2
S31508000BF0DB6A0F22934319007B681A6B1B4B0A4367
S31508000C00DA621A4B5B681E4A134019007B68DA6A77
S31508000C107B689B6A1A43154B0A435A60134B1A683A
S31508000C20124B802149040A431A60FFF723FC03008C
S31508000C30BB6108E0FFF71EFC0200BB69D31A022B52
S31508000C4001D9032354E0094B1A6880239B041340F7
S31508000C50F0D04CE0054B1A68044B08490A401A6064
S31508000C60FFF708FC0300BB6115E0C0460010024010
S31508000C7088130000FFFFFFEFFFFFFEFFFFFFFFFEE9
S31508000C80FF7FC2FFFFF7F6FB0200BB69D31A022BF0
S31508000C9001D903232CE0184B1A6880239B041340C0
S31508000CA0F0D124E07B685B6A012B01D101231FE0A8
S31508000CB0114B5B687B61104BDB6A3B617A69C02329
S31508000CC05B021A407B689B6A9A420ED13B690F22E7
S31508000CD01A407B681B6B9A4207D17A69F0239B03FB
S31508000CE01A407B68DB6A9A4201D0012300E00023A0
S31508000CF01800BD4608B080BD0010024080B584B01B
S31508000D0000AF786039607B68002B01D10123BFE012
S31508000D10614B1B68012213403A689A4211D95E4B0F
S31508000D201B680122934319005B4B3A680A431A6011
S31508000D30594B1B68012213403A689A4201D0012395
S31508000D40A6E07B681B680222134015D07B681B68E7
S31508000D500422134006D0514B5A68504BE021C90073
S31508000D600A435A604D4B5B68F022934319007B682F
S31508000D709A684A4B0A435A607B681B6801221340EB
S31508000D804CD07B685B68012B07D1444B1A688023DB
S31508000D909B02134020D101237AE07B685B68022B13
S31508000DA007D13E4B1A6880239B04134014D10123B4
S31508000DB06EE07B685B68032B07D1384B5A6B802340
S31508000DC05B02134008D1012362E0344B1B68022200
S31508000DD0134001D101235BE0304B5B680322934348
S31508000DE019007B685A682D4B0A435A60FFF742FB85
S31508000DF00300FB6009E0FFF73DFB0200FB68D31A1E
S31508000E00274A934201D9032342E0244B5B680C220C
S31508000E101A407B685B689B009A42ECD11E4B1B68A4
S31508000E20012213403A689A4211D21B4B1B680122D1
S31508000E3093431900184B3A680A431A60164B1B6805
S31508000E40012213403A689A4201D0012320E07B68C8
S31508000E501B680422134009D0104B5B68114A1340E3
S31508000E6019007B68DA680D4B0A435A6000F020F8CF
S31508000E7001000A4B5B681B090F2213400A4AD35C20
S31508000E800A00DA40094B1A600020FFF7ADFA002382
S31508000E901800BD4604B080BD002002400010024084
S31508000EA088130000FFF8FFFF3C1000080000002030
S31508000EB090B58FB000AF1423FB18374A13CA13C373
S31508000EC012681A603B1D354A13CA13C312681A60A2
S31508000ED00023FB620023BB6200237B6300237B6243
S31508000EE000233B632E4B5B68FB62FB6A0C221340B4
S31508000EF0082B06D00C2B43D0042B44D1294B3B633B
S31508000F0044E0FB6A9B0C0F2213401422BA18D35CE8
S31508000F107B62234BDB6A0F2213403A1DD35CBB620C
S31508000F20FA6AC0235B021A4080235B029A4209D1FF
S31508000F30B96A1C48FFF7E8F803001A007B6A5343AE
S31508000F407B631AE0FA6AC0235B021A40C0235B027D
S31508000F509A4209D1B96A1448FFF7D6F803001A006D
S31508000F607B6A53437B6308E0B96A0E48FFF7CCF8FF
S31508000F7003001A007B6A53437B637B6B3B6305E084
S31508000F80094B3B6302E0074B3B63C0463B6B1800CB
S31508000F90BD460FB090BDC0461C1000082C100008B6
S31508000FA00010024000127A00006CDC0270B50026C0
S31508000FB00C4D0D4C641BA410A64209D1002600F066
S31508000FC021F80A4D0A4C641BA410A64205D170BD2F
S31508000FD0B300EB5898470136EEE7B300EB5898474D
S31508000FE00136F2E74C1000084C1000084C100008B7
S31508000FF05010000803001218934200D17047197068
S315080010000133F9E7F8B5C046F8BC08BC9E467047F8
S31108001010F8B5C046F8BC08BC9E46704700
S3150800101C02030405060708090A0B0C0D0E0F10101F
S3150800102C0102030405060708090A0B0C0D0E0F101E
S3150800103C000000000000000001020304060708096E
S3090800104CE9000008A1
S30908001050C1000008C5
S3110800105400127A000400000001000000F1
S7050800033DB2`.split('\n'));


const array = new ArrayBuffer( 10 );

const bin1 = new Uint8Array( array, 0, 5);
const bin2 = new Uint8Array( array, 5, 5);
    bin1[0] = 0;
    bin1[1] = 0xFF;
    bin1[2] = 0xAA;
    bin1[3] = 0x55;
    bin2[0] = 0;
    bin2[1] = 0x1;
    bin2[2] = 0x2;
    bin2[3] = 0x33;


import { Pipe, PipeTransform } from '@angular/core';

@Pipe({ name: 'dec2hex' })
export class Dex2HexPipe implements PipeTransform {
  transform( value: number ) {
    return ('00' + value.toString( 16 ).toUpperCase() ).substr(-2);
  }
}


@Component({
  selector: 'hex-byte',
  template: '<span (click)="clicked()" [ngClass]="active ? \'active\' : \'non\'">{{value | dec2hex}}</span>',
  styles: [ '.active { border: 1px solid #000 }', 'span { user-select: all }' ]
})
export class HexByteComponent {
  @Input() value: number;
  
  active: boolean = true;
  constructor() {}
  
  clicked() {
    this.active = !this.active;
  }
}


@Component({
  selector: 'hex-view',
  template: '<hex-byte *ngFor="let byte of data" [value]="byte"></hex-byte>'
})
export class HexViewComponent {
  @Input() data: Uint8Array;
  constructor() {
  }
}



@Component({
  selector: 'app-test-view',
  templateUrl: './test-view.component.html',
  styleUrls: ['./test-view.component.scss']
})
export class TestViewComponent implements OnInit {
  srec: Block[] = [];
  constructor() {
    const reader = new SRecordReader();
    const writer = new SRecordWriter();
    try {
      
      }catch( err ){
        console.log(err)
      }
  }
  ngOnInit() {
    input.pipe( str2srec() ).subscribe( res => console.log( res ));
  }
}
